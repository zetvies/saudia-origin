<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Saudia QR Code</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
      @font-face {
        font-family: 'SaudiaSans';
        src: url('./assets/font/SaudiaSans-Regular.otf') format('opentype');
        font-weight: 400;
        font-style: normal;
      }
      @font-face {
        font-family: 'SaudiaSans';
        src: url('./assets/font/SaudiaSans-Bold.otf') format('opentype');
        font-weight: 700;
        font-style: normal;
      }
      @font-face {
        font-family: 'SaudiaSans';
        src: url('./assets/font/SaudiaSans-Light.otf') format('opentype');
        font-weight: 300;
        font-style: normal;
      }
      @font-face {
        font-family: 'SaudiaSans';
        src: url('./assets/font/SaudiaSans-Medium.otf') format('opentype');
        font-weight: 500;
        font-style: normal;
      }
      @font-face {
        font-family: 'SaudiaSans';
        src: url('./assets/font/SaudiaSans-SemiBold.otf') format('opentype');
        font-weight: 600;
        font-style: normal;
      }
      @font-face {
        font-family: 'SaudiaSans';
        src: url('./assets/font/SaudiaSans-ExtraBold.otf') format('opentype');
        font-weight: 800;
        font-style: normal;
      }
      @font-face {
        font-family: 'SaudiaSans';
        src: url('./assets/font/SaudiaSans-Black.otf') format('opentype');
        font-weight: 900;
        font-style: normal;
      }
      
      body {
        font-family: 'SaudiaSans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      }
    </style>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              "saudia-green": "#006400",
              "saudia-light-green": "#228B22",
              "saudia-blue": "#87CEEB",
              "saudia-light-blue": "#98FB98",
            },
            fontFamily: {
              'saudia': ['SaudiaSans', 'sans-serif'],
            },
          },
        },
      };
    </script>
  </head>
  <body
    class="w-screen h-screen flex justify-center items-center"
  >
  <div id="container" class="h-[100svh] w-[100svh] relative flex flex-col items-center justify-center text-saudia-green relative overflow-hidden p-5"
  style="
    background-image: url('./assets/bg.png');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
  ">
  <img src="./assets/decoration.png" class="h-[20svh] absolute top-0 left-0 "/>
  <img src="./assets/decoration.png" class="h-[20svh] absolute bottom-0 right-0 rotate-180" />
    <img src="./assets/logo.svg" class="h-[12svh]" />
    <div class="flex flex-col items-center text-center w-full justify-center mt-[4svh] mb-[8svh]">
        <div class="text-[2.2svh] font-bold mb-4">
            Senayan City, Jakarta, 29th - 31st August 2025
        </div>
        
        <div class="text-[3.6svh] font-bold">
            "The world is closer with Saudia"
        </div>
    </div>
    <div
      class="text-center flex bg-white/90 backdrop-blur-md rounded-3xl p-[3svh] gap-[2svh] shadow-2xl border-2 border-saudia-green/20 max-w-lg w-full relative z-20 mb-[5svh]"
    >
      <div
        class="bg-white p-[2svh] rounded-2xl shadow-lg border-2 border-saudia-green/20 inline-block"
      >
        <div
          id="qrcode"
          class="w-[20svh] h-[20svh] flex items-center justify-center"
        ></div>
      </div>

      <div class="flex flex-col items-center text-center w-full justify-center">
        <p class="font-bold text-saudia-green/70 mb-4 text-[2.4svh]">
            Scan QR Code untuk Memulai
          </p>
        <p class="text-sm text-saudia-green/70 mb-4">
          Scan dengan kamera ponsel Anda,<br/> lalu isi form.
        </p>

        <div class="mt-4">
          <a
            href="./game.html"
            class="inline-block bg-gradient-to-r from-saudia-green to-saudia-light-green text-white px-6 py-2 rounded-lg text-sm font-semibold hover:shadow-lg transition-all duration-300"
          >
            Buka Game
          </a>
        </div>
      </div>
    </div>
  </div>

    <script>
      // WebSocket connection for form submission detection - automatically detect protocol
      const wsProtocol = window.location.protocol === "https:" ? "wss:" : "ws:";
      const ws = new WebSocket(`${wsProtocol}//${window.location.host}`);

      ws.onopen = function () {
        console.log("WebSocket connected to index page");
        console.log("WebSocket readyState:", ws.readyState);
      };

      ws.onmessage = function (event) {
        console.log("WebSocket message received in index.html:", event.data);
        const message = JSON.parse(event.data);
        console.log("Parsed message:", message);
        console.log("Message type:", message.type);
        
        if (message.type === "form-submitted") {
          console.log(
            "Form submitted detected, redirecting to game:",
            message.data
          );

          // Show notification
          showNotification("Form submitted! Redirecting to game...");

          // Redirect to game after 1 second
          setTimeout(() => {
            console.log("Redirecting to game.html now...");
            window.location.href = "/game.html";
          }, 1000);
        } else {
          console.log("Unknown message type:", message.type);
        }
      };

      ws.onerror = function (error) {
        console.error("WebSocket error:", error);
      };

      ws.onclose = function () {
        console.log("WebSocket disconnected from index page");
      };

      // Function to show notification
      function showNotification(message) {
        // Create notification element
        const notification = document.createElement("div");
        notification.className =
          "fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 transform transition-all duration-300 translate-x-full";
        notification.textContent = message;

        // Add to page
        document.body.appendChild(notification);

        // Animate in
        setTimeout(() => {
          notification.classList.remove("translate-x-full");
        }, 100);

        // Remove after 3 seconds
        setTimeout(() => {
          notification.classList.add("translate-x-full");
          setTimeout(() => {
            document.body.removeChild(notification);
          }, 300);
        }, 3000);
      }

      // Function to scale container by window dimensions
      function scaleContainer() {
        const container = document.getElementById('container');
        const scaleX = window.innerWidth / window.innerHeight;
        
        // Apply the scale transform
        container.style.transform = `scaleX(${scaleX})`;
        container.style.transformOrigin = 'center center';
      }

      // Generate QR Code
      document.addEventListener("DOMContentLoaded", function () {
        const qrCodeElement = document.getElementById("qrcode");
        const targetUrl = "https://saudia-origin-demo.onrender.com/form.html";

        // Create QR code using QRCode.js
        new QRCode(qrCodeElement, {
          text: targetUrl,
          width: 192,
          height: 192,
          colorDark: "#006400",
          colorLight: "#FFFFFF",
          correctLevel: QRCode.CorrectLevel.H,
        });

        // Scale container on initial load
        scaleContainer();
      });

      // Scale container on window resize
      window.addEventListener('resize', scaleContainer);
    </script>
  </body>
</html>
